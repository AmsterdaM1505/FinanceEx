# Личные финансы

Консольное Java-приложение для управления личными финансами.  
Позволяет вести учёт доходов и расходов, работать с категориями и бюджетами, выполнять переводы между пользователями, получать уведомления о превышении лимитов и сохранять данные между запусками.

## Структура проекта
```
project-root/
├── data/                               # Сохранённые данные приложения
│   ├── data.ser              
│   └── export_<name>.csv
│
├── src/
│   ├── Main/                           # Основные классы приложения
│   │   ├── Main.java         
│   │   ├── AuthService.java  
│   │   ├── FinanceService.java 
│   │   ├── StorageService.java 
│   │   ├── User.java         
│   │   ├── Wallet.java       
│   │   └── Transaction.java  
│   │
│   └── Tests/                          # Тесты
│       ├── AuthServiceTest.java
│       ├── FinanceAppIntegrationTest.java
│       ├── StorageServiceIntegrationTest.java
│       ├── WalletTest.java
│       └── UserTest.java
│
├── .gitignore
├── CutterEx.iml
└── README.md                           # Документация проекта
```

---

## Возможности

### Пользователи
- Регистрация и авторизация по логину и паролю
- Поддержка нескольких пользователей
- Выход из системы

### Доходы и расходы
- Добавление доходов и расходов
- Категоризация операций
- Комментарии (примечания) к транзакциям
- Просмотр всех транзакций

### Категории
- Создание категорий
- Переименование категорий
- Удаление категорий:
    - обычное (если нет транзакций)
    - принудительное (с удалением связанных транзакций)
- Просмотр информации по категории
- Список всех категорий с краткой статистикой

### Бюджеты
- Установка бюджета на категорию
- Автоматический расчёт:
    - потраченной суммы
    - оставшегося бюджета

### Оповещения
- Превышение бюджета по категории
- Использование ≥80% бюджета
- Общие расходы превышают доходы

### Переводы
- Переводы средств между пользователями
- Автоматическое создание транзакций:
    - расход у отправителя
    - доход у получателя

### Отчёты
- Сводка по пользователю:
    - общий доход
    - общие расходы
    - статистика по категориям
    - бюджеты и остатки
- Экспорт транзакций в CSV

### Хранение данных
- Автоматическое сохранение данных в файл
- Загрузка данных при старте приложения

---

## Архитектура проекта

Проект построен с разделением ответственности:

- **Main** - CLI-интерфейс и обработка команд
- **AuthService** - регистрация, авторизация, текущий пользователь
- **FinanceService** - бизнес-логика работы с финансами
- **StorageService** - сохранение и загрузка данных
- **User** - пользователь системы
- **Wallet** - кошелёк пользователя
- **Transaction** - финансовая операция

---

## Команды CLI

```text
register <login> <password>     регистрация пользователя
login <login> <password>        вход в систему
logout                          выход из системы
    
create-category <name>          создание категории
rename-category <old> <new>     переименование категории
delete-category <name>          удаление категории (без транзакций)
force-delete-category <name>    удаление категории с транзакциями

set-budget <category> <amount>  установка бюджета
add-income <category> <amount>  добавление дохода
add-expense <category> <amount> добавление расхода

transfer <toLogin> <amount>     перевод другому пользователю

category-info <name>            информация о категории
list-categories                 список всех категорий
transactions                    список транзакций
summary                         общая сводка

export-csv                      экспорт транзакций в CSV
save                            сохранение данных
exit                            выход из приложения
help                            справка по командам
```


---

## Пример использования
Данные с результатом использования из примера лежат в папке data
```text
Приложение: Личные финансы
Для справки по командам используйте help
> register test1 test1
Пользователь зарегистрирован.
> login test1 test1
Успешно: вошли как test1
> create-category еда
Категория создана: еда
> create-category развлечения
Категория создана: развлечения
> create-category ком_услуги
Категория создана: ком_услуги
> add-income зарплата 20000
Доход добавлен: [2026-01-04 17:17] INCOME | зарплата: 20000,00 
> add-income зарплата 40000
Доход добавлен: [2026-01-04 17:21] INCOME | зарплата: 40000,00 
> add-income бонус 3000
Доход добавлен: [2026-01-04 17:21] INCOME | бонус: 3000,00 
> set-budget еда 4000
Установлен бюджет еда = 4000,00
> set-budget развлечения 3000
Установлен бюджет развлечения = 3000,00
> set-budget ком_услуги
Использование: set-budget <category> <amount>
> set-budget ком_услуги 2500
Установлен бюджет ком_услуги = 2500,00
> add-expense еда 300
Расход добавлен: [2026-01-04 17:22] EXPENSE | еда: 300,00 
> add-expense уда 500
Категория не найдена. Создайте её или используйте существующую.
> add-expense еда 500
Расход добавлен: [2026-01-04 17:29] EXPENSE | еда: 500,00 
> add-expense развлечения 3000
Расход добавлен: [2026-01-04 17:29] EXPENSE | развлечения: 3000,00 
Предупреждение: вы использовали >=80% бюджета категории 'развлечения' (остаток 0,00).
> add-expense ком_услуги 3000
Расход добавлен: [2026-01-04 17:29] EXPENSE | ком_услуги: 3000,00 
Бюджет по категории 'ком_услуги' превышен на 500,00
> summary
Пользователь: test1
Общий доход: 63000,00
Доходы по категориям:
  бонус: 3000,00
  зарплата: 60000,00
Общие расходы: 6800,00
Расходы по категориям:
  развлечения: 3000,00
  еда: 800,00
  ком_услуги: 3000,00
Бюджеты по категориям и остатки:
  еда: 4000,00, Оставшийся бюджет: 3200,00
  развлечения: 3000,00, Оставшийся бюджет: 0,00
  ком_услуги: 2500,00, Оставшийся бюджет: -500,00
> export-csv
Экспортирован CSV в файл.
```

## Тестирование

В проекте реализованы тесты с использованием JUnit 5:

- AuthServiceTest - проверка функций регистрации и авторизации
- FinanceAppIntegrationTest - проверка функций полного сценария работы пользователя
- StorageServiceIntegrationTest - проверка функций сохранения и загрузки данных
- UserTest - проверка функций работы с пользователем и кошельком
- WalletTest - проверка функций кошелька

Для запуска тестов необходимо прописать следующие команды:
1. `dir /s /b src\Tests\*.java > test_sources.txt
          javac -encoding UTF-8 ^
            -cp "C:\junit\junit-platform-console-standalone.jar;out" ^
            -d out ^
            @test_sources.txt` - компиляция
2. `java -jar C:\junit\junit-platform-console-standalone.jar ^
            execute ^
            --class-path out ^
            --scan-class-path` - запуск

## Технологии

- Java
- IntelliJ IDEA
- JUnit 5
- Git

## Установка и запуск из GitHub
Клонировать репозиторий через `git clone`

В корне проекта открыть `cmd.exe` и запустить следующие команды:
### Компиляция
1. `rmdir /s /q out 2>nul`
2. `mkdir out`
3. `dir /s /b src\Main\*.java > sources.txt`
6. `javac -encoding UTF-8 -d out @sources.txt`
### Запуск
`java -cp out Main`

### CI/CD
В проекте реализован CI/CD конвейер на базе GitHub Actions с использованием self-hosted runner под Windows.
Конвейер включает этапы сборки, тестирования (с использованием JUnit 5) и развертывания результатов сборки.
